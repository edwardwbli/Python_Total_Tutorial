
# 包管理工具

由于python的包管理工具

## pip

pip是python的官方第三方包管理工具，收录了大部分的第三方包。多数自带python的系统如mac osx，
ubuntu都已经有现成的pip安装着了。如果确实没有pip可以去
[https://pip.pypa.io/en/latest/installing.html#python-os-support](https://pip.pypa.io/en/latest/installing.html#python-os-support)
学习使用和下载,[get-pip.py](https://bootstrap.pypa.io/get-pip.py)文件下载到本地后，cd到同一文件夹下使用`python get-pip.py`就可以安装了。
请务必一定确保要用的python及后面的虚拟环境可以使用pip工具，这是基础工具。

使用`virtualenv`构建的虚拟环境会自动安装pip工具,当进入虚拟环境后使用pip命令就是为你的虚拟环境安装依赖了

 
pip基本使用:

+ 安装模块

    $ pip install packageName           #最新的版本 
    
    $ pip install packageName==1.0.0    #指定版本
    
    $ pip install 'packageName>=1.0.0'  #最低版本
    
    $ pip install url  #从指定网址资源安装
    
    $ pip install path  #指定本地位置安装

    $ pip install --find-links=url #从指定url下载安装
    
    $ pip install --find-links=path #从指定path下载安装
    
    $ pip install --upgrade packageName #更新一个已经安装过的过期模块

+ 从需求文件安装模块

    $ pip freeze > requirements.txt     #将当前pip管理的模块信息存储进文本文件
    
    $ pip install -r requirements.txt   #从文本文件安装依赖的模块

+ 卸载

    $ pip uninstall packageName

+ 查找

    $ pip search name

+ 查看模块信息

    $ pip show packageName

+ 查看pip管理了哪些模块

    $ pip list
    
    $ pip list --outdated  #查看过期的模块



### 关于pip的国内源设置


感谢天朝的伟大电子长城,我们很多时候无法练到pypi的服务器,还好国内豆瓣有个一直在维护的镜像站可以提供源作为替代

如何设置呢?

在你的个人根目录下有一个.pip文件夹(没有就自己建个),在其中新建一个pip.conf文件作为配置文件,然后在其中填上如下内容:


    [global]
    index-url = http://pypi.douban.com/simple
    trusted-host = pypi.douban.com
    
    
就好了.


关于更多的pip的用法,可以看下快速入门第一节,在环境部分已经有很详细的描述

# 包安装模块(setuptools)

python在有pip之前都是下载到本地后使用setuptools来安装第三方模块的,
即便到了今天,这个依然是python包必用的工具.

## 用setuptools编写安装脚本

安装脚本`setup.py`就类似npm的`package.json`,它负责设定包的基本信息和依赖
setup.py:

```python
from distutils.core import setup

with open('requirements.txt') as f:
    required = f.read().splitlines()
"""
name--项目名
version--版本
author--作者
author_email--作者email
packages--要安装的包,一个列表,每个元素为包名字的字符串
package_data--包数据,一个字典,元素为包名:数据所在文件夹及文件
url--项目地址
license--协议
description--描述
long_description--open('readme.md').read(),文件
install_requires--依赖库
scripts--可以直接执行的文件,一个元素为脚本地址的列表
"""
setup(
    name='dota2Api',
    version='0.1.2',
    author='Huang Sizhe',
    author_email='hsz1273327@gmail.com',
    packages=['pkgname'],
    package_data={"pkgdata": ["source/*.json"]},
    url='url',
    license='MIT',
    description='some-description',
    long_description=open('README.txt').read(),
    install_requires=required,
    )
```


安装只要

    python setup.py install
    

## 将包注册到pypi服务器

1. 首先要有个pypi的账号,<https://pypi.python.org/pypi>可以选Register注册,注册的时候password必须大于16位,PGPkeyID可以不填.
表单提交好后登入邮箱验证即可注册完成.

2. 注册包

    cd到 项目根目录

        python setup.py register

    用刚才注册的信息来注册本台电脑

    注意直接这样会有可能报错,因为和原来有个名字太接近了.

    我们应该先检查下名字

        pip search <pkgname>

    用来查看有哪些相关的包,我们得确定没有重名

3. 然后就是上传

        Python setup.py sdist upload

4. 试试行不行

        pip install <pkgname>



